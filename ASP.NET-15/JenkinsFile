pipeline {
    agent none
    stages {
        stage('Build') {
            agent any
            steps {
                echo "time to show world our skill"
            }
        }
        steps('Test on Linux') {
            agent { 
                label 'Test'
            }
            steps{
                echo " ============== start building image for deploy  =================="
                dir ('ASP.NET-15/Shop-15') {
                sh ' sudo docker build  -t nazarserver/shoptest .'
                sh 'sudo docker run -d --restart=always -p 80:80  nazarserver/shoptest'    
            }
            }
        stage('Test on Windows') {
            agent {
                label 'ubuntu'
            }
           steps{
                echo "================ Start building images for integration========="
                dir ('ASP.NET-15/Shop-15') {
                sh ' sudo docker build  -t nazarserver/shop .'
                sh 'sudo docker run -d --restart=always -p 80:80  nazarserver/shop'
            }
        }
            }
        }
    }
 }
}
